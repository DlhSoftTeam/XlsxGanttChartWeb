var DlhSoft;"undefined"===typeof DlhSoft&&(DlhSoft={assemblies:[],buildReleaseDate:new Date(1,0,1)});DlhSoft.assemblies.push({assembly:"DlhSoft.ProjectData.PertChart.HTML.Controls",company:"DlhSoft",product:"Project Data Modern Library",version:"5.3.17.4",copyright:"Copyright \u00a9 2012-2020 DlhSoft",title:"Project Data PERT Chart HTML Controls",description:"Project Data PERT Chart related HTML client components"});
DlhSoft.buildReleaseDate=function(L,M,O){L=new Date(L,M-1,O);return L>DlhSoft.buildReleaseDate?L:DlhSoft.buildReleaseDate}(2020,11,25);var _0x5c25="Licensing{undefined{string{DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.{.{length{license{push{type{content{:{lastIndexOf{substr{buildReleaseDate{charCodeAt{pow{toUpperCase{DlhSoft Component Licensing Warning{http://DlhSoft.com/Purchase.aspx{?Assemblies={,{http://www.componentsource.com/features/dlhsoft{ (version {){This component is currently licensed to be used for testing purposes only{The component is part of this assembly{To purchase a standard license for a product that includes this assembly you can use the Purchase page{ownerDocument{div{createElement{style{position: absolute; left: 24px; top: 24px; width: 480px; display: block; z-index: 1; color: Black; background-color: #ffffc0; border: solid 1px Blue; overflow: auto{setAttribute{padding: 6px; padding-top: 8px; font-family: Arial; font-size: small{font-weight: bold; margin-bottom: 4px{appendChild{createTextNode{color: Red; margin-top: 2px; margin-bottom: 2px{margin-top: 4px{a{color: Blue; text-decoration: underline{href{target{_blank{Purchase license{margin-left: 4px; color: Blue; text-decoration: underline{javascript://{Continue trial{click{removeChild{addEventListener{\n\n{: {:\n".split("{");
void 0==DlhSoft[_0x5c25[0]]&&(DlhSoft[_0x5c25[0]]=function(){var L=_0x5c25[1],M=_0x5c25[2],O=[],T=[],U=_0x5c25[3],Z=function(I,D){if(typeof I!==M||typeof D!==M)return!1;if(D==U)return!0;var J=D[_0x5c25[11]](_0x5c25[10]);if(0<=J){var w=D[_0x5c25[12]](0,J),y,C=w[_0x5c25[11]](_0x5c25[10]);if(0<=C)try{y=new Date(parseInt(w[_0x5c25[12]](C+1)))}catch(x){}typeof y===L&&(y=new Date(2013,11,31));if(DlhSoft[_0x5c25[13]]>y)return!1;w=w+_0x5c25[10]+I;for(i=y=0;i<w[_0x5c25[5]];i++)C=w[_0x5c25[14]](i),y=(y<<5)-
y+C,y&=y;0>y&&(y=Math[_0x5c25[15]](2,32)-y);w=y.toString(16)[_0x5c25[16]]();J=D[_0x5c25[12]](J+1);if(w==J)return!0}return!1},P=function(I,D,J,w,y){var C=_0x5c25[17],x=_0x5c25[18],K=typeof ComponentSource===L||!ComponentSource?x+_0x5c25[19]+w+_0x5c25[20]+y:_0x5c25[21],E=w+_0x5c25[22]+y+_0x5c25[23],G=_0x5c25[24],F=_0x5c25[25],H=_0x5c25[26];setTimeout(function(){var A=I[_0x5c25[27]],y=A[_0x5c25[29]](_0x5c25[28]);y[_0x5c25[32]](_0x5c25[30],_0x5c25[31]);var w=A[_0x5c25[29]](_0x5c25[28]);w[_0x5c25[32]](_0x5c25[30],
_0x5c25[33]);var B=A[_0x5c25[29]](_0x5c25[28]);B[_0x5c25[32]](_0x5c25[30],_0x5c25[34]);w[_0x5c25[35]](B);B[_0x5c25[35]](A[_0x5c25[36]](C));w[_0x5c25[35]](A[_0x5c25[36]](G+_0x5c25[10]));B=A[_0x5c25[29]](_0x5c25[28]);B[_0x5c25[32]](_0x5c25[30],_0x5c25[37]);B[_0x5c25[35]](A[_0x5c25[36]](D));w[_0x5c25[35]](B);w[_0x5c25[35]](A[_0x5c25[36]](F+_0x5c25[10]));B=A[_0x5c25[29]](_0x5c25[28]);B[_0x5c25[32]](_0x5c25[30],_0x5c25[37]);B[_0x5c25[35]](A[_0x5c25[36]](E));w[_0x5c25[35]](B);w[_0x5c25[35]](A[_0x5c25[36]](H+
_0x5c25[10]));B=A[_0x5c25[29]](_0x5c25[28]);B[_0x5c25[32]](_0x5c25[30],_0x5c25[38]);var x=A[_0x5c25[29]](_0x5c25[39]);x[_0x5c25[32]](_0x5c25[30],_0x5c25[40]);x[_0x5c25[32]](_0x5c25[41],K);x[_0x5c25[32]](_0x5c25[42],_0x5c25[43]);x[_0x5c25[35]](A[_0x5c25[36]](_0x5c25[44]));B[_0x5c25[35]](x);x=A[_0x5c25[29]](_0x5c25[39]);x[_0x5c25[32]](_0x5c25[30],_0x5c25[45]);x[_0x5c25[32]](_0x5c25[41],_0x5c25[46]);x[_0x5c25[35]](A[_0x5c25[36]](_0x5c25[47]));x[_0x5c25[50]](_0x5c25[48],function(){I[_0x5c25[49]](y);T[_0x5c25[7]](J)},
!1);B[_0x5c25[35]](x);w[_0x5c25[35]](B);y[_0x5c25[35]](w);I[_0x5c25[35]](y)},0);setTimeout(function(){alert(C+_0x5c25[51]+G+_0x5c25[52]+D+_0x5c25[51]+F+_0x5c25[53]+E+_0x5c25[51]+H+_0x5c25[4])},6E5)};return{setLicense:function(I,D){O[_0x5c25[7]]({type:I,content:D})},validate:function(I,D,J,w,y,C,x){for(var D=D+_0x5c25[4]+J,K=0;K<T[_0x5c25[5]];K++)if(T[K]==D)return;a:if(typeof C!==M&&typeof x!==L&&(x[_0x5c25[6]]!==L&&(C=x[_0x5c25[6]]),typeof x===M&&(C=x)),typeof C!==M)for(x=0;x<O[_0x5c25[5]];x++)if(K=
O[x],K[_0x5c25[8]]==D&&typeof K[_0x5c25[9]]===M){C=K[_0x5c25[9]];break a}Z(D,C)?I[_0x5c25[6]]=C:P(I,J,D,w,y)}}}());void 0==DlhSoft.Controls&&(DlhSoft.Controls={});void 0==DlhSoft.Controls.Pert&&(DlhSoft.Controls.Pert={});
void 0==DlhSoft.Controls.Pert.PertChartView&&(DlhSoft.Controls.Pert.PertChartView=function(){var L=function(b,e,c,f){var a=["DlhSoft.Controls.Pert","PertChartView","DlhSoft.ProjectData.PertChart.HTML.Controls","5","validate","Licensing"];DlhSoft[a[5]][a[4]](b,a[0],a[1],a[2],a[3],f,c);b.isInitializing=true;if(typeof b.items!=="undefined")for(f=0;f<b.items.length;f++)delete b.items[f].successors;typeof c!=="object"&&(c={});U(e,c);T(c,e,b);ja(b,e,c);Z(e);var h=J(b,e,c),m=b.ownerDocument,f=m.createElement("div");
f.setAttribute("style","font-family: Arial; font-size: small; overflow: auto");a=m.createElement("div");typeof c.containerClass!=="undefined"&&a.setAttribute("class",c.containerClass);typeof c.containerStyle!=="undefined"&&a.setAttribute("style",c.containerStyle);f.appendChild(a);var d=m.createElement("div");d.setAttribute("style","border: solid 1px "+c.border+"; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: hidden");
a.appendChild(d);a=m.createElement("div");a.setAttribute("style","overflow: auto");d.appendChild(a);var g=m.createElement("div");g.setAttribute("style","overflow: "+(typeof c.isExport==="undefined"||!c.isExport?"auto":"hidden")+"; height: "+h);a.appendChild(g);var d=C(e,c),j=x(e,c),s=m.createElement("div");s.setAttribute("style","float: left; overflow: hidden; width: "+d+"px; height: "+j+"px");g.appendChild(s);h=m.createElementNS("http://www.w3.org/2000/svg","svg");h.setAttribute("style","width: "+
d+"px; height: "+j+"px");d=c.styleDefinitionTemplate();h.appendChild(d);h.chartAreaDefinitions=d;d=function(){setTimeout(function(){try{var a=s.chartArea,h=a.chartAreaDefinitions;a.removeChild(h);a.childNodes.length>0?a.insertBefore(h,a.childNodes[0]):a.appendChild(h)}catch(d){}},0)};h.addEventListener("mousedown",d,true);m.addEventListener("mouseup",d,true);s.appendChild(h);s.chartArea=h;var u;setTimeout(function(){u=b.clientHeight},0);typeof b.heightUpdateTimer!=="undefined"&&clearInterval(b.heightUpdateTimer);
b.heightUpdateTimer=setInterval(function(){try{if(!(b.clientHeight<=0)){var a=b.clientHeight;if(a!=u){var h=J(b,e,c);g.style.height=h;u=a}}}catch(d){try{clearInterval(b.heightUpdateTimer)}catch(m){}}},100);var k=function(a,h,d,b){var g;if(c.mouseHandler||c.mouseMoveHandler&&b=="mousemove"||c.mouseDownHandler&&b=="mousedown"||c.clickHandler&&b=="click"||c.doubleClickHandler&&b=="dblclick"){var j=a.which;!j&&a.button&&(a.button&1?j=1:a.button&4?j=2:a.button&2&&(j=3));g=d.getBoundingClientRect();var f=
m.body,s=m.documentElement,d=g.left+(window.pageXOffset||s.scrollLeft||f.scrollLeft)-(s.clientLeft||f.clientLeft||0);g=Math.round(g.top+(window.pageYOffset||s.scrollTop||f.scrollTop)-(s.clientTop||f.clientTop||0));d=Math.round(d);d=a.pageX-d;g=a.pageY-g;for(f=0;f<e.length;f++){var s=e[f],u=E(s,c),k=G(s,c);if(d>=u&&d<u+c.itemWidth&&g>=k&&g<k+c.itemHeight){c.mouseHandler&&c.mouseHandler(b,s,j,h,a);c.mouseMoveHandler&&b=="mousemove"&&c.mouseMoveHandler(s);c.mouseDownHandler&&b=="mousedown"&&c.mouseDownHandler(s,
j);c.itemClickHandler&&b=="click"&&c.itemClickHandler(s);c.itemDoubleClickHandler&&b=="dblclick"&&c.itemDoubleClickHandler(s)}}}};s.addEventListener("mousemove",function(a){k(a,0,s,"mousemove")});s.addEventListener("mousedown",function(a){k(a,1,s,"mousedown")});s.addEventListener("click",function(a){k(a,1,s,"click")});s.addEventListener("dblclick",function(a){k(a,2,s,"dblclick")});s.addEventListener("click",function(a){a.srcElement&&a.srcElement.nodeName!="rect"&&a.stopPropagation()},true);s.addEventListener("touchmove",
function(a){b.draggingItem&&a.preventDefault()},true);s.container=g;b.chartContainer=a;b.chartContent=s;b.chartContentContainer=g;g.isInitializing=true;ka(b,f);K(s,h,e,c);g.isInitializing=false;b.isInitializing=false;b.isInitialized=true;return b},M=function(b){L(b,b.items,b.settings,b.license)},O=function(b){if(typeof b.timeSpanFormatter==="undefined")b.timeSpanFormatter=y;if(typeof b.itemPropertyChangeHandler==="undefined")b.itemPropertyChangeHandler=function(){};if(typeof b.target==="undefined")b.target=
"Standard";if(typeof b.theme==="undefined")b.theme="Modern"},T=function(b,e,c){O(b);if(typeof b.border==="undefined")switch(b.theme){default:b.border="#e0e0e0";break;case "ModernBordered":case "Aero":b.border="#9a9a9a"}if(typeof b.canUserRearrangeItems==="undefined")b.canUserRearrangeItems=true;if(typeof b.snapRearrangedItemsToGuidelines==="undefined")b.snapRearrangedItemsToGuidelines=true;if(typeof b.itemWidth==="undefined")b.itemWidth=40;if(typeof b.itemHeight==="undefined")b.itemHeight=40;if(typeof b.aspectRatio===
"undefined")b.aspectRatio=1;if(typeof b.shapeWidth==="undefined")b.shapeWidth=32;if(typeof b.shapeHeight==="undefined")b.shapeHeight=32;if(typeof b.styleDefinitionTemplate==="undefined")b.styleDefinitionTemplate=W(c,b);if(typeof b.dependencyTextBlockWidth==="undefined")b.dependencyTextBlockWidth=120;if(typeof b.shapeStyle==="undefined"&&b.shapeClass==null)b.shapeStyle="fill: White; stroke: #606060; stroke-width: 0.75px";if(typeof b.temporaryThumbStyle==="undefined"&&b.temporaryThumbClass==null)b.temporaryThumbStyle=
"fill: none; stroke: #0000ff; stroke-width: 0.65px; stroke-dasharray: 2, 2; ";if(typeof b.dependencyLineStyle==="undefined"&&b.dependencyLineClass==null)b.dependencyLineStyle="stroke: #8080FF; stroke-width: 0.65px; fill: none; marker-end: url(#ArrowMarker)";if(typeof b.virtualEffortDependencyLineStyle==="undefined"&&b.virtualEffortDependencyLineClass==null)b.virtualEffortDependencyLineStyle="stroke: #8080FF; stroke-width: 0.65px; stroke-dasharray: 2, 2; fill: none; marker-end: url(#ArrowMarker)";
if(typeof b.dependencyLineZoneStyle==="undefined"&&b.dependencyLineZoneClass==null)b.dependencyLineZoneStyle="stroke: White; stroke-opacity: 0; stroke-width: 4px; fill: none";if(typeof b.taskEventTemplate==="undefined")b.taskEventTemplate=aa();if(typeof b.dependencyTextStyle==="undefined")b.dependencyTextStyle="color: #606060; text-anchor: middle";if(typeof b.chartMargin==="undefined")b.chartMargin=16;if(typeof b.isTaskEventToolTipVisible==="undefined")switch(b.target){default:b.isTaskEventToolTipVisible=
true;break;case "Phone":b.isTaskEventToolTipVisible=false}if(typeof b.itemTemplate==="undefined")b.itemTemplate=X(b);if(typeof b.dependencyLineTemplate==="undefined")b.dependencyLineTemplate=ba();if(typeof b.isDependencyToolTipVisible==="undefined")b.isDependencyToolTipVisible=b.isTaskEventToolTipVisible;if(typeof b.predecessorItemTemplate==="undefined")b.predecessorItemTemplate=la(b)},U=function(b){for(var e=0;e<b.length;e++){var c=b[e];if(typeof c==="string"){c={content:c};b[e]=c}if(typeof c.predecessors!==
"undefined"){if(typeof c.predecessors==="string")c.predecessors=c.predecessors.split(",");for(var f=0;f<c.predecessors.length;f++){var a=c.predecessors[f];if(typeof a==="string"){a={item:a};c.predecessors[f]=a}if(typeof a.item==="string"){var h=parseInt(a.item)-1;a.item=h>=0&&h<b.length?b[h]:null}if(typeof a.effort==="string")a.effort=parseFloat(a.effort)}}if(typeof c.displayedRowIndex!=="undefined")c.actualRowIndex=c.displayedRowIndex;if(typeof c.displayedColumnIndex!=="undefined")c.actualColumnIndex=
c.displayedColumnIndex;if(typeof c.actualRowIndex==="undefined")c.actualRowIndex=0;if(typeof c.actualColumnIndex==="undefined")c.actualColumnIndex=0}},Z=function(b){b.positionedItems=[];b.maxRowIndex=null;for(var e=0;e<b.length;e++){var c=b[e],f=b;if(typeof c.displayedRowIndex==="undefined"){var a;if(typeof c.predecessors!=="undefined"){a=f.positionedItems;for(var h=[],m=c.predecessors,d=0;d<a.length;d++)for(var g=a[d],j=0;j<m.length;j++)if(m[j].item==g){h.push(g);break}a=h}else a=null;if(a!=null){h=
a;m=[];for(d=0;d<h.length;d++){g=h[d].actualRowIndex;m.indexOf(g)<0&&m.push(g)}h=m}else h=null;h=h!=null&&h.length>0?R(h):f.maxRowIndex!=null?f.maxRowIndex+1:0;m=m=void 0;if(typeof c.displayedColumnIndex==="undefined"){m=P(f.positionedItems,h);m=m.length>0?R(m)+1:0;d=a!=null?P(a,h):null;if(d!=null&&d.length>0){g=null;for(j=0;j<d.length;j++)if(g==null||d[j]<g)g=d[j];d=g+1}else d=null;if(d!=null&&d!=m){h++;a=a!=null?I(a):null;m=a!=null&&a.length>0?R(a)+1:0}for(c.actualColumnIndex=m;D(f.positionedItems,
h,m);)h++}else for(;;h++){m=P(f.positionedItems,h);m=m.length>0?R(m)+1:0;if(m<=c.actualColumnIndex)break}c.actualRowIndex=h}else if(typeof c.displayedColumnIndex==="undefined"){a=I(f.positionedItems);c.actualColumnIndex=a.length>0?R(a)+1:0}f.positionedItems.push(c);if(f.maxRowIndex==null||c.actualRowIndex>f.maxRowIndex)f.maxRowIndex=c.actualRowIndex}},P=function(b,e){for(var c=[],f=0;f<b.length;f++){var a=b[f];if(a.actualRowIndex==e){a=a.actualColumnIndex;c.indexOf(a)<0&&c.push(a)}}return c},I=function(b){for(var e=
[],c=0;c<b.length;c++){var f=b[c].actualColumnIndex;e.indexOf(f)<0&&e.push(f)}return e},D=function(b,e,c){for(var f=0;f<b.length;f++){var a=b[f];if(a.actualRowIndex==e&&a.actualColumnIndex==c)return true}return false},J=function(b,e,c){var f;if(b.isContentHeightInitialized&&b.isContentHeightAuto)f=e.length>0?"auto":c.itemHeight+"px";else{var a=b.clientHeight-2;a<0&&(a=0);f=a+"px";if(a<c.itemHeight){if(!b.isContentHeightInitialized)b.isContentHeightAuto=true;f=e.length>0?"auto":c.itemHeight+"px"}b.isContentHeightInitialized=
true}return f},w=function(b,e){var c=b.createElement("span");c.innerHTML=e;return c},y=function(b){return Math.ceil(b/36E5*1E4/100)/100+"h"},C=function(b,e){for(var c=0,f=0;f<b.length;f++)c=Math.max(c,b[f].actualColumnIndex);return e.itemWidth+c*(e.itemWidth+e.dependencyTextBlockWidth)+e.chartMargin*2},x=function(b,e){for(var c=0,f=0;f<b.length;f++)c=Math.max(c,b[f].actualRowIndex);return e.itemHeight+c*(e.itemHeight+e.dependencyTextBlockWidth/e.aspectRatio)+e.chartMargin*2},K=function(b,e,c,f){for(b=
0;b<c.length;b++){var a=c[b],h=E(a,f),m=G(a,f);e.appendChild(H(a,h,m,f))}},E=function(b,e){if(typeof b.displayedColumnIndex!=="undefined")b.actualColumnIndex=b.displayedColumnIndex;return Math.max(0,e.chartMargin+b.actualColumnIndex*(e.itemWidth+e.dependencyTextBlockWidth))},G=function(b,e){if(typeof b.displayedRowIndex!=="undefined")b.actualRowIndex=b.displayedRowIndex;return Math.max(0,e.chartMargin+b.actualRowIndex*(e.itemHeight+e.dependencyTextBlockWidth/e.aspectRatio))},F=function(b){for(var e=
[],c,f,a=0;a<b.length;a++){var h=b[a];if(typeof h.predecessors!=="undefined"&&h.predecessors.length>0)for(var m=0;m<h.predecessors.length;m++){var d=h.predecessors[m].item;if(typeof d!=="undefined"){c=true;for(f=0;f<e;f++)if(d==e[f]){c=false;break}if(c){A(d.chartItem,d,d.pertChartView.settings);c=E(d,d.pertChartView.settings);f=G(d,d.pertChartView.settings);d.chartItem.setAttribute("transform","translate("+c+", "+f+")");e.push(d)}}}if(typeof h.predecessors!=="undefined"&&h.predecessors.length>0){c=
true;for(f=0;f<e;f++)if(typeof h!=="undefined"&&h==e[f]){c=false;break}if(c){A(h.chartItem,h,h.pertChartView.settings);c=E(h,h.pertChartView.settings);f=G(h,h.pertChartView.settings);h.chartItem.setAttribute("transform","translate("+c+", "+f+")");e.push(h)}}}},H=function(b,e,c,f){var a=b.pertChartView.ownerDocument.createElementNS("http://www.w3.org/2000/svg","g");b.chartItem=a;a.setAttribute("style","-ms-touch-action: pinch-zoom; touch-action: pinch-zoom");a.setAttribute("transform","translate("+
e+", "+c+")");A(a,b,f);return a},A=function(b,e,c){for(var f=b.childNodes.length;f-- >0;)b.removeChild(b.childNodes[f]);if(typeof e.isShapeVisible==="undefined"||e.isShapeVisible){f=c.taskEventTemplate;if(typeof e.taskEventTemplate!=="undefined")f=e.taskEventTemplate;f=f(e);b.appendChild(f);if(typeof c.internalExtraTaskTemplate!=="undefined"){var a=c.internalExtraTaskTemplate(e);a!=null&&b.appendChild(a)}if(typeof c.extraTaskEventTemplate!=="undefined"){a=c.extraTaskEventTemplate(e);a!=null&&b.appendChild(a)}if(c.isTaskEventToolTipVisible){a=
c.itemTemplate;if(typeof e.template!=="undefined")a=e.template;f.appendChild(a(e))}if(typeof e.predecessors!=="undefined")for(f=0;f<e.predecessors.length;f++){a=e.predecessors[f];if(!((typeof e.pertChartView==="undefined"||e.pertChartView.items.indexOf(a.item))<0)){var h=c.dependencyLineTemplate(e,a);h.predecessorIndex=f;(function(a){h.addEventListener("click",function(h){c.dependencyLineClickHandler&&c.dependencyLineClickHandler(a,e,h)});h.addEventListener("dblclick",function(h){c.dependencyLineDoubleClickHandler&&
c.dependencyLineDoubleClickHandler(a,e,h)})})(a);b.appendChild(h);if(c.isDependencyToolTipVisible){var m=c.predecessorItemTemplate;if(typeof a.template!=="undefined")m=a.template;h.appendChild(m(e,a))}}}}},V=function(b){if(typeof b.isWaitingToRefreshChartItem==="undefined"){b.isWaitingToRefreshChartItem=true;setTimeout(function(){A(b.chartItem,b,b.pertChartView.settings);var e=E(b,b.pertChartView.settings),c=G(b,b.pertChartView.settings);b.chartItem.setAttribute("transform","translate("+e+", "+c+
")");delete b.isWaitingToRefreshChartItem},0)}},Q=function(b){V(b)},B=function(b){if(typeof b.isWaitingToRefreshPredecessorItems==="undefined"){b.isWaitingToRefreshPredecessorItems=true;setTimeout(function(){F(b.pertChartView.items,b);delete b.isWaitingToRefreshPredecessorItems},0)}},$=function(b){if(typeof b.isWaitingToRefreshChartItem!=="undefined"||typeof b.isWaitingToRefreshPredecessorItems!=="undefined"){typeof b.isWaitingToRefreshChartItem==="undefined"&&V(b);typeof b.isWaitingToRefreshPredecessorItems===
"undefined"&&B(b)}else{b.isWaitingToRefreshChartItem=true;b.isWaitingToRefreshPredecessorItems=true;setTimeout(function(){A(b.chartItem,b,b.pertChartView.settings);var e=E(b,b.pertChartView.settings),c=G(b,b.pertChartView.settings);b.chartItem.setAttribute("transform","translate("+e+", "+c+")");F(b.pertChartView.items,b);delete b.isWaitingToRefreshChartItem;delete b.isWaitingToRefreshPredecessorItems},0)}},W=function(b){return function(){var e=b.ownerDocument,c=e.createElementNS("http://www.w3.org/2000/svg",
"defs"),f=e.createElementNS("http://www.w3.org/2000/svg","marker");f.setAttribute("id","ArrowMarker");f.setAttribute("viewBox","0 0 10 10");f.setAttribute("refX","0");f.setAttribute("refY","5");f.setAttribute("markerUnits","strokeWidth");f.setAttribute("markerWidth","5");f.setAttribute("markerHeight","4");f.setAttribute("orient","auto");e=e.createElementNS("http://www.w3.org/2000/svg","path");e.setAttribute("fill","#8080ff");e.setAttribute("d","M 0 0 L 10 5 L 0 10 z");f.appendChild(e);c.appendChild(f);
return c}},X=function(){return function(b){var e=b.pertChartView.ownerDocument,c=e.createElementNS("http://www.w3.org/2000/svg","title");c.appendChild(w(e,typeof b.content!=="undefined"?b.content:""));return c}},aa=function(b,e,c){return function(f){var a=typeof e!=="undefined"?e:f.pertChartView,h=typeof c!=="undefined"?c:a.settings,m=typeof b!=="undefined"?b:a.items,d=a.ownerDocument,g;g=f.pertChartView.ownerDocument;if(typeof f.chartItemArea==="undefined")f.chartItemArea=g.createElementNS("http://www.w3.org/2000/svg",
"g");for(g=f.chartItemArea.childNodes.length;g-- >0;)f.chartItemArea.removeChild(f.chartItemArea.childNodes[g]);g=f.chartItemArea;var j=(h.itemWidth-h.shapeWidth)/2,s=j+h.shapeWidth,u=(h.itemHeight-h.shapeHeight)/2,k=u+h.shapeHeight,p=h.shapeHeight,n,r=d.createElementNS("http://www.w3.org/2000/svg","rect");r.setAttribute("x",j);r.setAttribute("y",u);r.setAttribute("width",Math.max(0,s-j-1));r.setAttribute("height",Math.max(0,k-u-1));r.setAttribute("rx",h.shapeWidth/10);r.setAttribute("ry",h.shapeHeight/
10);n=h.shapeClass;if(typeof f.shapeClass!=="undefined")n=f.shapeClass;if(typeof n!=="undefined")r.setAttribute("class",n);else{n=h.shapeStyle;if(typeof f.shapeStyle!=="undefined")n=f.shapeStyle;typeof n!=="undefined"&&r.setAttribute("style",n)}g.appendChild(r);r=d.createElementNS("http://www.w3.org/2000/svg","text");r.setAttribute("x",(j+s)/2);r.setAttribute("y",k-p*1.5/8-6);r.setAttribute("style","font-weight: bold; text-anchor: middle");p=f.displayedText;typeof p==="undefined"&&(p="");r.appendChild(d.createTextNode(p));
g.appendChild(r);if(h.canUserRearrangeItems){d=d.createElementNS("http://www.w3.org/2000/svg","rect");d.setAttribute("x",j);d.setAttribute("y",u);d.setAttribute("width",Math.max(0,s-j-1));d.setAttribute("height",Math.max(0,k-u-1));d.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer");g.appendChild(d);ca(d,f,m,E(f,h),G(f,h),a,h)}return g}},ba=function(b,e){return function(b,f){var a=b.pertChartView,h=typeof e!=="undefined"?e:a.settings,a=a.ownerDocument,m=a.createElementNS("http://www.w3.org/2000/svg",
"g"),d=void 0,g=void 0,j,s="M ",d=E(b,h)-2,g=G(b,h)-2,u=E(f.item,h);j=G(f.item,h);var k=E(b,h),p=G(b,h),n=Math.abs(k-u),r=Math.abs(p-j),t=h.shapeWidth+2,o=h.shapeHeight+2,q=t/2,v=o/2,l=Math.max(t,o),r=r<l*4;if(n<l)s=j<=p?s+(u+q-d+","+(j+o-g))+(" L "+(k+q-d)+","+(p-g)):s+(u+q-d+","+(j-g))+(" L "+(k+q-d)+","+(p+o-g));else{s=u<=k?s+(u+t-d+","+(j+v-g)):s+(u-d+","+(j+v-g));s=r?u<=k?s+(" L "+(k-d)+","+(p+v-g)):s+(" L "+(k+t-d)+","+(p+v-g)):j<=p?s+(" L "+(k+q-d)+","+(p-g)):s+(" L "+(k+q-d)+","+(p+o-g))}d=
((u<=k?u:k)+(u>=k?u:k))/2+q-d;g=((j<=p?j:p)+(j>=p?j:p))/2+v-g;j=s;s=a.createElementNS("http://www.w3.org/2000/svg","path");s.setAttribute("d",j);typeof h.dependencyLineZoneClass!=="undefined"&&s.setAttribute("class",h.dependencyLineZoneClass);typeof h.dependencyLineZoneStyle!=="undefined"&&s.setAttribute("style",h.dependencyLineZoneStyle);m.appendChild(s);s=a.createElementNS("http://www.w3.org/2000/svg","path");s.setAttribute("d",j);if(typeof f.isEffortVirtual!=="undefined"?!f.isEffortVirtual:typeof f.effort!==
"undefined"&&f.effort>0){j=h.dependencyLineClass;if(typeof f.dependencyLineClass!=="undefined")j=f.dependencyLineClass;typeof j!=="undefined"&&s.setAttribute("class",j);j=h.dependencyLineStyle;if(typeof f.dependencyLineStyle!=="undefined")j=f.dependencyLineStyle}else{j=h.virtualEffortDependencyLineClass;if(typeof f.virtualEffortDependencyLineClass!=="undefined")j=f.virtualEffortDependencyLineClass;typeof j!=="undefined"&&s.setAttribute("class",j);j=h.virtualEffortDependencyLineStyle;if(typeof f.virtualEffortDependencyLineStyle!==
"undefined")j=f.virtualEffortDependencyLineStyle}typeof j!=="undefined"&&s.setAttribute("style",j);m.appendChild(s);s=a.createElementNS("http://www.w3.org/2000/svg","text");s.setAttribute("x",d);s.setAttribute("y",g-6);g=h.dependencyTextClass;if(typeof f.dependencyTextClass!=="undefined")g=f.dependencyTextClass;typeof g!=="undefined"&&s.setAttribute("class",g);h=h.dependencyTextStyle;if(typeof f.dependencyTextStyle!=="undefined")h=f.dependencyTextStyle;s.setAttribute("style",h);h=f.displayedText;
typeof h==="undefined"&&(h="");s.appendChild(a.createTextNode(h));m.appendChild(s);return m}},la=function(){return function(b,e){var c=b.pertChartView.ownerDocument,f=c.createElementNS("http://www.w3.org/2000/svg","title");f.appendChild(w(c,typeof e.content!=="undefined"?e.content:""));return f}},S=function(b,e,c,f){typeof b.pertChartView!=="undefined"&&b.pertChartView.settings.itemPropertyChangeHandler(b,e,c,f)},ca=function(b,e,c,f,a,h,m){function d(d){h.draggingItem=e;h.dragType="Position";h.style.cursor=
b.style.cursor;h.draggingInitialX=d.clientX;h.draggingInitialY=d.clientY;h.draggingInitialThumbXPosition=f;h.draggingInitialThumbYPosition=a}b.addEventListener("mousedown",function(a){if(a.button==0){d(a);a.preventDefault()}},true);b.addEventListener("touchstart",function(a){d(a.touches[0]);a.preventDefault()},true);if(typeof h.draggableItems==="undefined")h.draggableItems=[];for(var g=false,j=0;j<h.draggableItems.length;j++)if(h.draggableItems[j]==e){g=true;break}if(!g){var s=function(a){if(!(typeof h.draggingItem===
"undefined"||h.draggingItem!=e||h.dragType!="Position")){var d=a.clientX-h.draggingInitialX,b=a.clientY-h.draggingInitialY;var g=a.clientX,j=h;if(typeof j.draggingItem!=="undefined"){var f=j,s=0;if(f.offsetParent){do{s=s+f.offsetLeft;f=f.offsetParent}while(f)}g=g-s;if(g<24){g=j.chartContentContainer.scrollLeft;j.chartContentContainer.scrollLeft=j.chartContentContainer.scrollLeft-48;g=g-j.chartContentContainer.scrollLeft;if(typeof j.draggingInitialThumbXPosition!=="undefined")j.draggingInitialThumbXPosition=
j.draggingInitialThumbXPosition-g}else if(g>=j.chartContentContainer.clientWidth-24){g=j.chartContentContainer.scrollLeft;j.chartContentContainer.scrollLeft=j.chartContentContainer.scrollLeft+48;g=j.chartContentContainer.scrollLeft-g;if(typeof j.draggingInitialThumbXPosition!=="undefined")j.draggingInitialThumbXPosition=j.draggingInitialThumbXPosition+g}}j=a.clientY;a=h;if(typeof a.draggingItem!=="undefined"){g=a;f=0;if(g.offsetParent){do{f=f+g.offsetTop;g=g.offsetParent}while(g)}j=j-f;if(j<24){j=
a.chartContentContainer.scrollTop;a.chartContentContainer.scrollTop=a.chartContentContainer.scrollTop-48;j=j-a.chartContentContainer.scrollTop;if(typeof a.draggingInitialThumbYPosition!=="undefined")a.draggingInitialThumbYPosition=a.draggingInitialThumbYPosition-j}else if(j>=a.chartContentContainer.clientHeight-24){j=a.chartContentContainer.scrollTop;a.chartContentContainer.scrollTop=a.chartContentContainer.scrollTop+48;j=a.chartContentContainer.scrollTop-j;if(typeof a.draggingInitialThumbYPosition!==
"undefined")a.draggingInitialThumbYPosition=a.draggingInitialThumbYPosition+j}}delete h.draggingItem;h.draggingInitialThumbXPosition+d<0&&(d=-h.draggingInitialThumbXPosition);h.draggingInitialThumbYPosition+b<0&&(b=-h.draggingInitialThumbYPosition);a=e;b=(h.draggingInitialThumbYPosition+b-m.chartMargin)/(m.itemHeight+m.dependencyTextBlockWidth/m.aspectRatio);m.snapRearrangedItemsToGuidelines&&(b=Math.round(b));a.actualRowIndex=b;b=e;d=(h.draggingInitialThumbXPosition+d-m.chartMargin)/(m.itemWidth+
m.dependencyTextBlockWidth);m.snapRearrangedItemsToGuidelines&&(d=Math.round(d));b.actualColumnIndex=d;S(e,"actualRowIndex",true,false);S(e,"actualColumnIndex",true,false);typeof e.displayedColumnIndex!=="undefined"&&delete e.displayedColumnIndex;typeof e.displayedRowIndex!=="undefined"&&delete e.displayedRowIndex;da(e,c,h.chartContent,m,false);h.draggingItem=e;h.draggingPerformed=true}};h.addEventListener("mousemove",function(a){s(a)},true);h.addEventListener("touchmove",function(a){s(a.touches[0])},
true);var u=function(){if(!(typeof h.draggingItem==="undefined"||h.draggingItem!=e||h.dragType!="Position")){da(e,c,h.chartContent,m,true);var a=h.draggingItem;delete h.draggingItem;h.style.cursor="default";if(h.draggingPerformed){S(a,"actualColumnIndex",true,true);S(a,"actualRowIndex",true,true);delete h.draggingPerformed}}};document.addEventListener("mouseup",function(a){a.button==0&&u()},true);document.addEventListener("touchend",function(){u()},true);h.draggableItems.push(e)}},da=function(b,e,
c,f,a){var h=b.pertChartView.ownerDocument;if(a){if(typeof c.temporaryRectangle!=="undefined"){h=c.chartArea;h.removeChild(c.temporaryRectangle);delete c.temporaryRectangle}setTimeout(function(){A(b.chartItem,b,f);F(e,b);setTimeout(function(){N(c,e,f,true)},0)})}else{if(typeof c.temporaryRectangle!=="undefined")a=c.temporaryRectangle;else{a=h.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x",0);a.setAttribute("y",0);a.setAttribute("width",f.shapeWidth);a.setAttribute("height",
f.shapeHeight);a.setAttribute("rx",f.shapeWidth/10);a.setAttribute("ry",f.shapeHeight/10);typeof f.temporaryThumbClass!=="undefined"&&a.setAttribute("class",f.temporaryThumbClass);a.setAttribute("style",f.temporaryThumbStyle);c.temporaryRectangle=a;h=c.chartArea;h.appendChild(a)}var h=E(b,f)+(f.itemWidth-f.shapeWidth)/2,m=G(b,f)+(f.itemHeight-f.shapeHeight)/2;a.setAttribute("transform","translate("+h+", "+m+")");setTimeout(function(){N(c,e,f,false)},0)}},N=function(b,e,c,f){var a=C(e,c),e=x(e,c);
if(f||a>b.clientWidth)b.style.width=a+"px";if(f||e>b.clientHeight)b.style.height=e+"px";b=b.chartArea;f?b.setAttribute("style","width: "+a+"px; height: "+e+"px"):b.setAttribute("style","width: "+Math.max(b.clientWidth,a)+"px; height: "+Math.max(b.clientHeight,e)+"px")},ka=function(b,e){for(var c=b.childNodes.length;c-- >0;)b.removeChild(b.childNodes[c]);b.appendChild(e)},ma=function(b,e){for(var c in e)c.indexOf("custom")!=0&&c.indexOf("description")!=0||typeof b[c]==="undefined"&&(b[c]=e[c])},ea=
function(b,e,c,f,a,h,m,d){var d={isExport:true,canUserRearrangeItems:false,isTaskEventToolTipVisible:false,isDependencyToolTipVisible:false,containerClass:d.containerClass,containerStyle:d.containerStyle,border:d.border,theme:d.theme,itemWidth:d.itemWidth,itemHeight:d.itemHeight,aspectRatio:d.aspectRatio,shapeWidth:d.shapeWidth,shapeHeight:d.shapeHeight,shapeClass:d.shapeClass,shapeStyle:d.shapeStyle,shapeCornerRadius:d.shapeCornerRadius,dependencyTextStyle:d.dependencyTextStyle,dependencyLineClass:d.dependencyLineClass,
dependencyLineStyle:d.dependencyLineStyle,virtualEffortDependencyLineClass:d.virtualEffortDependencyLineClass,virtualEffortDependencyLineStyle:d.virtualEffortDependencyLineStyle,dependencyTextBlockWidth:d.dependencyTextBlockWidth,chartMargin:0,target:d.target,timeSpanFormatter:d.timeSpanFormatter,taskEventTemplate:d.taskEventTemplate,dependencyLineTemplate:d.dependencyLineTemplate},g=C(m,d),j=x(m,d);d.chartWidth=g+"px";d.chartHeight=j+"px";var s=g+2,g=j+2,u,k,p=false;if(c!=null&&typeof c.createElement!==
"undefined")u=c;else{if(c!=null&&typeof c.focus!=="undefined")k=c;else{k=window.open("",c!=null?c:"_blank",typeof f!=="undefined"&&f&&(typeof h==="undefined"||h)?"width=320,height=100,location=no,menubar=no,toolbar=no,status=no,scrollbars=yes":"");p=true}u=k.document;try{for(var n=document.head.getElementsByTagName("link"),c=0;c<n.length;c++){var r=n[c],t=u.adoptNode(r.cloneNode(true));t.href=r.href;u.head.appendChild(t)}}catch(o){}}u.title=typeof b!=="undefined"?b:"Exported chart"+(typeof f!=="undefined"&&
f?" (printable)":"");b=[];for(c=0;c<m.length;c++){n=m[c];r={content:n.content,displayedText:n.displayedText,isShapeVisible:n.isShapeVisible,shapeClass:n.shapeClass,shapeStyle:n.shapeStyle,dependencyTextStyle:n.dependencyTextStyle,displayedRowIndex:n.actualRowIndex,displayedColumnIndex:n.actualColumnIndex,isExported:true};ma(r,n);b.push(r);n.exportItem=r}for(c=0;c<m.length;c++){n=m[c];r=n.exportItem;if(typeof n.predecessors!=="undefined"){r.predecessors=[];for(t=0;t<n.predecessors.length;t++){j=n.predecessors[t];
r.predecessors.push({item:j.item.exportItem,content:j.content,displayedText:j.displayedText,effort:j.effort,isEffortVirtual:j.isEffortVirtual,dependencyLineClass:j.dependencyLineClass,dependencyLineStyle:j.dependencyLineStyle,virtualEffortDependencyLineClass:j.virtualEffortDependencyLineClass,virtualEffortDependencyLineStyle:j.virtualEffortDependencyLineStyle,dependencyTextStyle:j.dependencyTextStyle})}}}var q=u.createElement("p");q.innerHTML=typeof e!=="undefined"?e:"";u.body.appendChild(q);var v=
u.createElement("div");v.setAttribute("style","width: "+s+"px; height: "+g+"px");try{DlhSoft.Controls.Pert.PertChartView.initialize(v,b,d,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")}catch(l){}setTimeout(function(){p&&u.body.setAttribute("style","margin: 0px");var d=u.createElement("div");d.appendChild(v);u.body.replaceChild(d,q);if(a){d.setAttribute("style","width: "+v.offsetHeight+"px; height: "+s+"px; overflow: hidden");
d=Math.round((v.offsetWidth-v.offsetHeight)/2);v.setAttribute("style","width: "+s+"px; transform: rotate(90deg) translateX("+d+"px) translateY("+d+"px); -webkit-transform: rotate(90deg) translateX("+d+"px) translateY("+d+"px)")}u.close();if(typeof k!==void 0){k.focus();if(typeof f!=="undefined"&&f){k.print();(typeof h==="undefined"||h)&&setTimeout(function(){k.close()})}}},0)},na=function(b,e){for(var c=0;c<e.length;c++){var f=e[c];delete f.successorInfo;delete f.effortInfo}typeof b==="undefined"&&
(b=0);c=Y(e);if(c==null)return[];for(var c=[c],f=fa(b,e),a=0;a<f.length;a++)c.push(f[a].dependentItem);return c},fa=function(b,e){for(var c=0;c<e.length;c++){var f=e[c];delete f.successorInfo;delete f.effortInfo}var a=Y(e);if(a==null)return[];a:{for(c=e.length;c-- >0;){f=e[c];if(ga(f).length==0){c=f;break a}}c=null}if(c==null)return[];c=ha(a,c);a=[];for(f=0;f<c.length;f++)a.push(c[f]);for(c=0;c<e.length;c++){f=e[c];delete f.successorInfo;delete f.effortInfo}return a},ha=function(b,e){if(b==null||
e==null||b==e||typeof e.predecessors==="undefined")return[];var c=[],f=[],a,h=null;for(a=0;a<e.predecessors.length;a++){predecessorItem=e.predecessors[a];predecessorItem.dependentItem=e;if(typeof predecessorItem.item!=="undefined"){var m=ia(b,predecessorItem.item);if(m!=null){if((typeof predecessorItem.isEffortVirtual==="undefined"||!predecessorItem.isEffortVirtual)&&predecessorItem.effort>0)m=m+predecessorItem.effort;if(h==null||m>=h){if(h==null||m>h){h=m;f=[]}f.push(predecessorItem)}}}}for(a=0;a<
f.length;a++){for(var h=f[a],m=ha(b,h.item),d=0;d<m.length;d++)c.push(m[d]);c.push(h)}return c},Y=function(b){for(var e=0;e<b.length;e++){var c=b[e];if(typeof c.predecessors==="undefined"||c.predecessors.length==0)return c}return null},ia=function(b,e){if(b==null||e==null)return null;if(b==e)return 0;if(!b.effortInfo)b.effortInfo={};var c=e.index.toString();if(typeof b.effortInfo[c]!=="undefined")return b.effortInfo[c];for(var f=null,a=ga(b),h=0;h<a.length;h++){var m=a[h],d=ia(m.dependentItem,e);
if(d!=null){d=d+((typeof predecessorItem.isEffortVirtual==="undefined"||!predecessorItem.isEffortVirtual)&&m.predecessorItem.effort>0?m.predecessorItem.effort:0);d<0&&(d=0);if(f==null||d>f)f=d}}f!=null&&(b.effortInfo[c]=f);return f},ga=function(b){if(b.successorInfo)return b.successorInfo;for(var e=[],c=b.pertChartView.items,f=0;f<c.length;f++){var a=c[f];if(typeof a.predecessors!=="undefined")for(var h=0;h<a.predecessors.length;h++){var m=a.predecessors[h];typeof m.item!=="undefined"&&m.item==b&&
e.push({dependentItem:a,predecessorItem:m})}}return b.successorInfo=e},R=function(b){for(var e=null,c=0;c<b.length;c++)if(e==null||b[c]>e)e=b[c];return e},ja=function(b,e,c){for(var f=0;f<e.length;f++){e[f].pertChartView=b;e[f].index=f}b.items=e;b.settings=c;b.refresh=function(){M(b)};b.refreshItems=function(){for(var a=0;a<e.length;a++){var h=e[a];V(h);B(h)}};b.refreshChartItems=function(){for(var a=0;a<e.length;a++)V(e[a])};b.refreshItem=Q;b.refreshChartItem=V;b.refreshPredecessorItems=B;b.refreshItemGraph=
$;b.scrollToItem=function(a){var h=E(a,c),b=h-a.pertChartView.chartContentContainer.scrollLeft;if(b<0)a.pertChartView.chartContentContainer.scrollLeft=h;else if(b>a.pertChartView.chartContentContainer.clientWidth-a.pertChartView.settings.itemWidth)a.pertChartView.chartContentContainer.scrollLeft=h-(a.pertChartView.chartContentContainer.clientWidth-a.pertChartView.settings.itemWidth);h=G(a,c);b=h-a.pertChartView.chartContentContainer.scrollTop;if(b<0)a.pertChartView.chartContentContainer.scrollTop=
h;else if(b>a.pertChartView.chartContentContainer.clientHeight-a.pertChartView.settings.itemHeight)a.pertChartView.chartContentContainer.scrollTop=h-(a.pertChartView.chartContentContainer.clientHeight-a.pertChartView.settings.itemHeight)};b.scrollToLeft=function(){b.chartContentContainer.scrollLeft=0};b.scrollToRight=function(){b.chartContentContainer.scrollLeft=b.chartContent.clientWidth};b.scrollToTop=function(){b.chartContentContainer.scrollTop=0};b.scrollToBottom=function(){b.chartContentContainer.scrollTop=
b.chartContent.clientHeight};b.getChartWidth=function(){return C(e,c)};b.getChartHeight=function(){return x(e,c)};b.getItemTop=function(a){return G(a,c)};b.getItemLeft=function(a){return E(a,c)};b.onItemPropertyChanged=S;b.initializeTasEventkDraggingThumbs=function(a,h,m,d){ca(a,h,b.items,m,d,b,b.settings)};b.exportContent=function(a,h){typeof a==="undefined"&&(a={});ea(a.title,a.preparingMessage,h,false,a.rotate,false,e,c)};b.print=function(a){typeof a==="undefined"&&(a={});ea(a.title,a.preparingMessage,
null,true,a.rotate,a.autoClose,e,c)};b.isItemCritical=function(a,h){return na(h,e).indexOf(a)>=0};b.isDependencyCritical=function(a,h){return fa(h,e).indexOf(a)>=0};b.getCriticalItems=function(a){return na(a,e)};b.getCriticalDependencies=function(a){return fa(a,e)};b.repositionEnds=function(){if(e.length!=0){for(var a=false,h=0;h<e.length;h++){for(var b=e[h],d=0,g=0;g<e.length;g++){var j=e[g];if(typeof j.predecessors!=="undefined"){for(var c=0;c<j.predecessors.length;c++)if(typeof j.predecessors[c].item!==
"undefined"&&j.predecessors[c].item==b){d++;if(d>1)break}if(d>1)break}}d>1&&(a=true)}h=e[0];h.displayedRowIndex=a?0.5:0;b=e[e.length-1];b.displayedRowIndex=a?0.5:0;$(h);$(b)}}};return{initialize:L,initializeItems:U,refresh:M,getDefaultStyleDefinitionTemplate:W,getDefaultTaskEventTemplate:aa,getDefaultItemTemplate:X,getDefaultDependencyLineTemplate:ba,getDefaultPredecessorItemTemplate:la,initializeTaskEventDraggingThumbs:function(b,e,c,f){e.pertChartView.initializeTaskEventDraggingThumbs(b,e,c,f)},
defaultTimeSpanFormatter:y}}());
void 0==DlhSoft.Controls.Pert.NetworkDiagramView&&(DlhSoft.Controls.Pert.NetworkDiagramView=function(){var L=function(a,h,b,d){var g=["DlhSoft.Controls.Pert","NetworkDiagramView","DlhSoft.ProjectData.PertChart.HTML.Controls","5","validate","Licensing"];DlhSoft[g[5]][g[4]](a,g[0],g[1],g[2],g[3],d,b);a.isInitializing=true;if(typeof a.items!=="undefined")for(d=0;d<a.items.length;d++)delete a.items[d].successors;typeof b!=="object"&&(b={});U(h,b);T(b,h,a);f(a,h,b);x(h,b);Z(h);var j=J(a,h,b),c=a.ownerDocument,
d=c.createElement("div");d.setAttribute("style","font-family: Arial; font-size: small; overflow: auto");g=c.createElement("div");typeof b.containerClass!=="undefined"&&g.setAttribute("class",b.containerClass);typeof b.containerStyle!=="undefined"&&g.setAttribute("style",b.containerStyle);d.appendChild(g);var e=c.createElement("div");e.setAttribute("style","border: solid 1px "+b.border+"; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: hidden");
g.appendChild(e);g=c.createElement("div");g.setAttribute("style","overflow: auto");e.appendChild(g);var k=c.createElement("div");k.setAttribute("style","overflow: "+(typeof b.isExport==="undefined"||!b.isExport?"auto":"hidden")+"; height: "+j);g.appendChild(k);var e=K(h,b),p=E(h,b),n=c.createElement("div");n.setAttribute("style","float: left; overflow: hidden; width: "+e+"px; height: "+p+"px");k.appendChild(n);j=c.createElementNS("http://www.w3.org/2000/svg","svg");j.setAttribute("style","width: "+
e+"px; height: "+p+"px");e=b.styleDefinitionTemplate();j.appendChild(e);j.chartAreaDefinitions=e;e=function(){setTimeout(function(){try{var a=n.chartArea,d=a.chartAreaDefinitions;a.removeChild(d);a.childNodes.length>0?a.insertBefore(d,a.childNodes[0]):a.appendChild(d)}catch(h){}},0)};j.addEventListener("mousedown",e,true);c.addEventListener("mouseup",e,true);n.appendChild(j);n.chartArea=j;var r;setTimeout(function(){r=a.clientHeight},0);typeof a.heightUpdateTimer!=="undefined"&&clearInterval(a.heightUpdateTimer);
a.heightUpdateTimer=setInterval(function(){try{if(!(a.clientHeight<=0)){var d=a.clientHeight;if(d!=r){var g=J(a,h,b);k.style.height=g;r=d}}}catch(j){try{clearInterval(a.heightUpdateTimer)}catch(c){}}},100);var t=function(a,d,g,j){var f;if(b.mouseHandler||b.mouseMoveHandler&&j=="mousemove"||b.mouseDownHandler&&j=="mousedown"||b.clickHandler&&j=="click"||b.doubleClickHandler&&j=="dblclick"){var e=a.which;!e&&a.button&&(a.button&1?e=1:a.button&4?e=2:a.button&2&&(e=3));f=g.getBoundingClientRect();var u=
c.body,k=c.documentElement,g=f.left+(window.pageXOffset||k.scrollLeft||u.scrollLeft)-(k.clientLeft||u.clientLeft||0);f=Math.round(f.top+(window.pageYOffset||k.scrollTop||u.scrollTop)-(k.clientTop||u.clientTop||0));g=Math.round(g);g=a.pageX-g;f=a.pageY-f;for(u=0;u<h.length;u++){var k=h[u],t=F(k,b),n=H(k,b);if(g>=t&&g<t+b.itemWidth&&f>=n&&f<n+b.itemHeight){b.mouseHandler&&b.mouseHandler(j,k,e,d,a);b.mouseMoveHandler&&j=="mousemove"&&b.mouseMoveHandler(k);b.mouseDownHandler&&j=="mousedown"&&b.mouseDownHandler(k,
e);b.itemClickHandler&&j=="click"&&b.itemClickHandler(k);b.itemDoubleClickHandler&&j=="dblclick"&&b.itemDoubleClickHandler(k)}}}};n.addEventListener("mousemove",function(a){t(a,0,n,"mousemove")});n.addEventListener("mousedown",function(a){t(a,1,n,"mousedown")});n.addEventListener("click",function(a){t(a,1,n,"click")});n.addEventListener("dblclick",function(a){t(a,2,n,"dblclick")});n.addEventListener("click",function(a){a.srcElement&&a.srcElement.nodeName!="rect"&&a.stopPropagation()},true);n.addEventListener("touchmove",
function(d){a.draggingItem&&d.preventDefault()},true);n.container=k;a.chartContainer=g;a.chartContent=n;a.chartContentContainer=k;k.isInitializing=true;na(a,d);G(n,j,h,b);k.isInitializing=false;a.isInitializing=false;a.isInitialized=true;return a},M=function(a){L(a,a.items,a.settings,a.license)},O=function(a){if(typeof a.dateTimeFormatter==="undefined")a.dateTimeFormatter=y;if(typeof a.timeSpanFormatter==="undefined")a.timeSpanFormatter=C;if(typeof a.itemPropertyChangeHandler==="undefined")a.itemPropertyChangeHandler=
function(){};if(typeof a.target==="undefined")a.target="Standard";if(typeof a.theme==="undefined")a.theme="Modern"},T=function(a,h,b){O(a);if(typeof a.border==="undefined")switch(a.theme){default:a.border="#e0e0e0";break;case "ModernBordered":case "Aero":a.border="#9a9a9a"}if(typeof a.canUserRearrangeItems==="undefined")a.canUserRearrangeItems=true;if(typeof a.snapRearrangedItemsToGuidelines==="undefined")a.snapRearrangedItemsToGuidelines=true;if(typeof a.itemWidth==="undefined")a.itemWidth=220;if(typeof a.itemHeight===
"undefined")a.itemHeight=100;if(typeof a.aspectRatio==="undefined")a.aspectRatio=1;if(typeof a.shapeWidth==="undefined")a.shapeWidth=212;if(typeof a.shapeHeight==="undefined")a.shapeHeight=92;if(typeof a.styleDefinitionTemplate==="undefined")a.styleDefinitionTemplate=aa(b,a);if(typeof a.shapeStyle==="undefined"&&a.shapeClass==null)a.shapeStyle="fill: White; stroke: #0000ff; stroke-width: 1px";if(typeof a.milestoneStyle==="undefined"&&a.milestoneClass==null)a.milestoneStyle="fill: White; stroke: #000000; stroke-width: 1px";
if(typeof a.temporaryThumbStyle==="undefined"&&a.temporaryThumbClass==null)a.temporaryThumbStyle="fill: none; stroke: #0000ff; stroke-width: 0.65px; stroke-dasharray: 2, 2; ";if(typeof a.dependencyLineStyle==="undefined"&&a.dependencyLineClass==null)a.dependencyLineStyle="stroke: #8080FF; stroke-width: 0.65px; fill: none; marker-end: url(#ArrowMarker)";if(typeof a.dependencyLineZoneStyle==="undefined"&&a.dependencyLineZoneClass==null)a.dependencyLineZoneStyle="stroke: White; stroke-opacity: 0; stroke-width: 4px; fill: none";
if(typeof a.taskTemplate==="undefined")a.taskTemplate=S();if(typeof a.minDependencyLineLength==="undefined")a.minDependencyLineLength=48;if(typeof a.diagramMargin==="undefined")a.diagramMargin=16;if(typeof a.isTaskToolTipVisible==="undefined")switch(a.target){default:a.isTaskToolTipVisible=true;break;case "Phone":a.isTaskToolTipVisible=false}if(typeof a.itemTemplate==="undefined")a.itemTemplate=ba(a);if(typeof a.dependencyLineTemplate==="undefined")a.dependencyLineTemplate=ca();if(typeof a.isDependencyToolTipVisible===
"undefined")a.isDependencyToolTipVisible=a.isTaskToolTipVisible;if(typeof a.predecessorItemTemplate==="undefined")a.predecessorItemTemplate=da(a)},U=function(a,h){for(var b=new Date,d=0;d<a.length;d++){var g=a[d];if(typeof g==="string"){g={content:g};a[d]=g}if(typeof g.earlyStart==="string"){try{g.earlyStart=Date.parse(g.earlyStart)}catch(j){g.earlyStart=new Date(parseInt(g.earlyStart))}if(typeof h.isRelativeToTimezone==="undefined"||h.isRelativeToTimezone)g.earlyStart=new Date(g.earlyStart.valueOf()+
b.getTimezoneOffset()*6E4)}if(typeof g.earlyFinish==="string"){try{g.earlyFinish=Date.parse(g.earlyFinish)}catch(c){g.earlyFinish=new Date(parseInt(g.earlyFinish))}if(typeof h.isRelativeToTimezone==="undefined"||h.isRelativeToTimezone)g.earlyFinish=new Date(g.earlyFinish.valueOf()+b.getTimezoneOffset()*6E4)}if(typeof g.lateStart==="string"){try{g.lateStart=Date.parse(g.lateStart)}catch(f){g.lateStart=new Date(parseInt(g.lateStart))}if(typeof h.isRelativeToTimezone==="undefined"||h.isRelativeToTimezone)g.lateStart=
new Date(g.lateStart.valueOf()+b.getTimezoneOffset()*6E4)}if(typeof g.lateFinish==="string"){try{g.lateFinish=Date.parse(g.lateFinish)}catch(e){g.lateFinish=new Date(parseInt(g.lateFinish))}if(typeof h.isRelativeToTimezone==="undefined"||h.isRelativeToTimezone)g.earlyFinish=new Date(g.earlyFinish.valueOf()+b.getTimezoneOffset()*6E4)}if(typeof g.effort==="string")try{g.effort=parseInt(g.effort)}catch(p){}if(typeof g.isMilestone==="string")g.isMilestone=g.isMilestone.toLowerCase()==trueStringValue;
if(typeof g.slack==="string")try{g.slack=parseInt(g.slack)}catch(n){}if(typeof g.predecessors!=="undefined"){if(typeof g.predecessors==="string")g.predecessors=g.predecessors.split(",");for(var r=0;r<g.predecessors.length;r++){var t=g.predecessors[r];if(typeof t==="string"){t={item:t};g.predecessors[r]=t}if(typeof t.item==="string"){var o=parseInt(t.item)-1;t.item=o>=0&&o<a.length?a[o]:null}if(typeof t.lag==="string")t.lag=parseFloat(t.lag)}}if(typeof g.displayedRowIndex!=="undefined")g.actualRowIndex=
g.displayedRowIndex;if(typeof g.displayedColumnIndex!=="undefined")g.actualColumnIndex=g.displayedColumnIndex;if(typeof g.actualRowIndex==="undefined")g.actualRowIndex=0;if(typeof g.actualColumnIndex==="undefined")g.actualColumnIndex=0}},Z=function(a){a.positionedItems=[];a.maxRowIndex=null;for(var h=0;h<a.length;h++){var m=a[h],d=a;if(typeof m.displayedRowIndex==="undefined"){var g;if(typeof m.predecessors!=="undefined"){g=d.positionedItems;for(var j=[],c=m.predecessors,f=0;f<g.length;f++)for(var e=
g[f],p=0;p<c.length;p++)if(c[p].item==e){j.push(e);break}g=j}else g=null;if(g!=null){j=g;c=[];for(f=0;f<j.length;f++){e=j[f].actualRowIndex;c.indexOf(e)<0&&c.push(e)}j=c}else j=null;j=j!=null&&j.length>0?b(j):d.maxRowIndex!=null?d.maxRowIndex+1:0;c=c=void 0;if(typeof m.displayedColumnIndex==="undefined"){c=P(d.positionedItems,j);c=c.length>0?b(c)+1:0;f=g!=null?P(g,j):null;if(f!=null&&f.length>0){e=null;for(p=0;p<f.length;p++)if(e==null||f[p]<e)e=f[p];f=e+1}else f=null;if(f!=null&&f!=c){j++;g=g!=null?
I(g):null;c=g!=null&&g.length>0?b(g)+1:0}for(m.actualColumnIndex=c;D(d.positionedItems,j,c);)j++}else for(;;j++){c=P(d.positionedItems,j);c=c.length>0?b(c)+1:0;if(c<=m.actualColumnIndex)break}m.actualRowIndex=j}else if(typeof m.displayedColumnIndex==="undefined"){g=I(d.positionedItems);m.actualColumnIndex=g.length>0?b(g)+1:0}d.positionedItems.push(m);if(d.maxRowIndex==null||m.actualRowIndex>d.maxRowIndex)d.maxRowIndex=m.actualRowIndex}},P=function(a,h){for(var b=[],d=0;d<a.length;d++){var g=a[d];
if(g.actualRowIndex==h){g=g.actualColumnIndex;b.indexOf(g)<0&&b.push(g)}}return b},I=function(a){for(var h=[],b=0;b<a.length;b++){var d=a[b].actualColumnIndex;h.indexOf(d)<0&&h.push(d)}return h},D=function(a,h,b){for(var d=0;d<a.length;d++){var g=a[d];if(g.actualRowIndex==h&&g.actualColumnIndex==b)return true}return false},J=function(a,h,b){var d;if(a.isContentHeightInitialized&&a.isContentHeightAuto)d=h.length>0?"auto":b.itemHeight+"px";else{var g=a.clientHeight-2;g<0&&(g=0);d=g+"px";if(g<b.itemHeight){if(!a.isContentHeightInitialized)a.isContentHeightAuto=
true;d=h.length>0?"auto":b.itemHeight+"px"}a.isContentHeightInitialized=true}return d},w=function(a,b){var c=a.createElement("span");c.innerHTML=b;return c},y=function(a){var b;b=a.getFullYear();var c=a.getMonth()+1;c<10&&(c="0"+c);var d=a.getDate();d<10&&(d="0"+d);b=c+"/"+d+"/"+b;c=a.getHours();c<10&&(c="0"+c.toString());a=a.getMinutes();a<10&&(a="0"+a.toString());return b+" "+c+":"+a},C=function(a){return Math.ceil(a/36E5*1E4/100)/100+"h"},x=function(a){var b=new Date(Math.floor((new Date).valueOf()/
864E5)*864E5),c=new Date,d,g;for(g=0;g<a.length;g++){d=a[g];var j=d.earlyStart,f=d.earlyFinish,e=d.lateStart,k=d.lateFinish;if(typeof d.earlyStart==="undefined")d.earlyStart=b;if(typeof d.earlyFinish==="undefined")d.earlyFinish=typeof d.isMilestone==="undefined"||!d.isMilestone?new Date(b.valueOf()+864E5):d.earlyStart;if(typeof d.lateStart==="undefined")d.lateStart=b;if(typeof d.lateFinish==="undefined")d.lateFinish=typeof d.isMilestone==="undefined"||!d.isMilestone?new Date(b.valueOf()+864E5):d.lateStart;
if(typeof d.isRelativeToTimezone==="undefined"||d.isRelativeToTimezone){d.earlyStart=new Date(d.earlyStart.valueOf()-c.getTimezoneOffset()*6E4);d.earlyFinish=new Date(d.earlyFinish.valueOf()-c.getTimezoneOffset()*6E4);d.lateStart=new Date(d.lateStart.valueOf()-c.getTimezoneOffset()*6E4);d.lateFinish=new Date(d.lateFinish.valueOf()-c.getTimezoneOffset()*6E4);d.isRelativeToTimezone=false}if(typeof d.effort==="undefined")d.effort=0;if(typeof d.slack==="undefined")d.slack=0;if(typeof d.isMilestone===
"undefined")d.isMilestone=false;(typeof j==="undefined"||d.earlyStart.valueOf()!=j.valueOf())&&N(d,"earlyStart",false,true);(typeof f==="undefined"||d.earlyFinish.valueOf()!=f.valueOf())&&N(d,"earlyFinish",false,true);(typeof e==="undefined"||d.lateStart.valueOf()!=e.valueOf())&&N(d,"lateStart",false,true);(typeof k==="undefined"||d.lateFinish.valueOf()!=k.valueOf())&&N(d,"lateFinish",false,true)}},K=function(a,b){for(var c=0,d=0;d<a.length;d++)c=Math.max(c,a[d].actualColumnIndex);return b.itemWidth+
c*(b.itemWidth+b.minDependencyLineLength)+b.diagramMargin*2},E=function(a,b){for(var c=0,d=0;d<a.length;d++)c=Math.max(c,a[d].actualRowIndex);return b.itemHeight+c*(b.itemHeight+b.minDependencyLineLength/b.aspectRatio)+b.diagramMargin*2},G=function(a,b,c,d){for(a=0;a<c.length;a++){var g=c[a],j=F(g,d),f=H(g,d);b.appendChild(V(g,j,f,d))}},F=function(a,b){if(typeof a.displayedColumnIndex!=="undefined")a.actualColumnIndex=a.displayedColumnIndex;return Math.max(0,b.diagramMargin+a.actualColumnIndex*(b.itemWidth+
b.minDependencyLineLength))},H=function(a,b){if(typeof a.displayedRowIndex!=="undefined")a.actualRowIndex=a.displayedRowIndex;return Math.max(0,b.diagramMargin+a.actualRowIndex*(b.itemHeight+b.minDependencyLineLength/b.aspectRatio))},A=function(a){for(var b=[],c,d,g=0;g<a.length;g++){var j=a[g];if(typeof j.predecessors!=="undefined"&&j.predecessors.length>0)for(var f=0;f<j.predecessors.length;f++){var e=j.predecessors[f].item;if(typeof e!=="undefined"){c=true;for(d=0;d<b;d++)if(e==b[d]){c=false;break}if(c){Q(e.chartItem,
e,e.networkDiagramView.settings);c=F(e,e.networkDiagramView.settings);d=H(e,e.networkDiagramView.settings);e.chartItem.setAttribute("transform","translate("+c+", "+d+")");b.push(e)}}}if(typeof j.predecessors!=="undefined"&&j.predecessors.length>0){c=true;for(d=0;d<b;d++)if(typeof j!=="undefined"&&j==b[d]){c=false;break}if(c){Q(j.chartItem,j,j.networkDiagramView.settings);c=F(j,j.networkDiagramView.settings);d=H(j,j.networkDiagramView.settings);j.chartItem.setAttribute("transform","translate("+c+", "+
d+")");b.push(j)}}}},V=function(a,b,c,d){var g=a.networkDiagramView.ownerDocument.createElementNS("http://www.w3.org/2000/svg","g");a.chartItem=g;g.setAttribute("style","-ms-touch-action: pinch-zoom; touch-action: pinch-zoom");g.setAttribute("transform","translate("+b+", "+c+")");Q(g,a,d);return g},Q=function(a,b,c){for(var d=a.childNodes.length;d-- >0;)a.removeChild(a.childNodes[d]);if(typeof b.isShapeVisible==="undefined"||b.isShapeVisible){d=c.taskTemplate;if(typeof b.taskTemplate!=="undefined")d=
b.taskTemplate;d=d(b);a.appendChild(d);if(typeof c.internalExtraTaskTemplate!=="undefined"){var g=c.internalExtraTaskTemplate(b);g!=null&&a.appendChild(g)}if(typeof c.extraTaskTemplate!=="undefined"){g=c.extraTaskTemplate(b);g!=null&&a.appendChild(g)}if(c.isTaskToolTipVisible){g=c.itemTemplate;if(typeof b.template!=="undefined")g=b.template;d.appendChild(g(b))}if(typeof b.predecessors!=="undefined")for(d=0;d<b.predecessors.length;d++){g=b.predecessors[d];if(!((typeof b.networkDiagramView==="undefined"||
b.networkDiagramView.items.indexOf(g.item))<0||typeof g.item.isShapeVisible!=="undefined"&&!g.item.isShapeVisible)){var j=c.dependencyLineTemplate(b,g);j.predecessorIndex=d;(function(a){j.addEventListener("click",function(d){c.dependencyLineClickHandler&&c.dependencyLineClickHandler(a,b,d)});j.addEventListener("dblclick",function(d){c.dependencyLineDoubleClickHandler&&c.dependencyLineDoubleClickHandler(a,b,d)})})(g);a.appendChild(j);if(c.isDependencyToolTipVisible){var f=c.predecessorItemTemplate;
if(typeof g.template!=="undefined")f=g.template;j.appendChild(f(b,g))}}}}},B=function(a){if(typeof a.isWaitingToRefreshChartItem==="undefined"){a.isWaitingToRefreshChartItem=true;setTimeout(function(){Q(a.chartItem,a,a.networkDiagramView.settings);var b=F(a,a.networkDiagramView.settings),c=H(a,a.networkDiagramView.settings);a.chartItem.setAttribute("transform","translate("+b+", "+c+")");delete a.isWaitingToRefreshChartItem},0)}},$=function(a){B(a)},W=function(a){if(typeof a.isWaitingToRefreshPredecessorItems===
"undefined"){a.isWaitingToRefreshPredecessorItems=true;setTimeout(function(){A(a.networkDiagramView.items,a);delete a.isWaitingToRefreshPredecessorItems},0)}},X=function(a){if(typeof a.isWaitingToRefreshChartItem!=="undefined"||typeof a.isWaitingToRefreshPredecessorItems!=="undefined"){typeof a.isWaitingToRefreshChartItem==="undefined"&&B(a);typeof a.isWaitingToRefreshPredecessorItems==="undefined"&&W(a)}else{a.isWaitingToRefreshChartItem=true;a.isWaitingToRefreshPredecessorItems=true;setTimeout(function(){Q(a.chartItem,
a,a.networkDiagramView.settings);var b=F(a,a.networkDiagramView.settings),c=H(a,a.networkDiagramView.settings);a.chartItem.setAttribute("transform","translate("+b+", "+c+")");A(a.networkDiagramView.items,a);delete a.isWaitingToRefreshChartItem;delete a.isWaitingToRefreshPredecessorItems},0)}},aa=function(a){return function(){var b=a.ownerDocument,c=b.createElementNS("http://www.w3.org/2000/svg","defs"),d=b.createElementNS("http://www.w3.org/2000/svg","marker");d.setAttribute("id","ArrowMarker");d.setAttribute("viewBox",
"0 0 10 10");d.setAttribute("refX","0");d.setAttribute("refY","5");d.setAttribute("markerUnits","strokeWidth");d.setAttribute("markerWidth","5");d.setAttribute("markerHeight","4");d.setAttribute("orient","auto");b=b.createElementNS("http://www.w3.org/2000/svg","path");b.setAttribute("fill","#8080ff");b.setAttribute("d","M 0 0 L 10 5 L 0 10 z");d.appendChild(b);c.appendChild(d);return c}},ba=function(){return function(a){var b=a.networkDiagramView.ownerDocument,c=b.createElementNS("http://www.w3.org/2000/svg",
"title");c.appendChild(w(b,a.content));return c}},la=function(a){var b=a.networkDiagramView.ownerDocument;if(typeof a.chartItemArea==="undefined")a.chartItemArea=b.createElementNS("http://www.w3.org/2000/svg","g");for(b=a.chartItemArea.childNodes.length;b-- >0;)a.chartItemArea.removeChild(a.chartItemArea.childNodes[b]);return a.chartItemArea},S=function(a,b,c){return function(d){var g=typeof b!=="undefined"?b:d.networkDiagramView,j=typeof c!=="undefined"?c:g.settings,f=typeof a!=="undefined"?a:g.items,
e=g.ownerDocument,k=la(d),p=(j.itemWidth-j.shapeWidth)/2,n=p+j.shapeWidth,r=(j.itemHeight-j.shapeHeight)/2,t=r+j.shapeHeight,o=0,q=j.shapeHeight,v=j.shapeWidth;if(d.isMilestone){o=v/16;p=p+o;n=n-o;v=v-2*o}if(d.isMilestone){var l=e.createElementNS("http://www.w3.org/2000/svg","polygon");l.setAttribute("points",p+","+r+" "+(p-o)+","+(r+t)/2+" "+p+","+t+" "+n+","+t+" "+(n+o)+","+(r+t)/2+" "+n+","+r);o=j.milestoneClass;if(typeof d.milestoneClass!=="undefined")o=d.milestoneClass;if(typeof o!=="undefined")l.setAttribute("class",
o);else{o=j.milestoneStyle;if(typeof d.milestoneStyle!=="undefined")o=d.milestoneStyle;typeof o!=="undefined"&&l.setAttribute("style",o)}k.appendChild(l)}l=e.createElementNS("http://www.w3.org/2000/svg","rect");l.setAttribute("x",p);l.setAttribute("y",r);l.setAttribute("width",Math.max(0,n-p-1));l.setAttribute("height",Math.max(0,t-r-1));o=j.shapeClass;if(typeof d.shapeClass!=="undefined")o=d.shapeClass;if(typeof o!=="undefined")l.setAttribute("class",o);else{o=j.shapeStyle;if(typeof d.shapeStyle!==
"undefined")o=d.shapeStyle;typeof o!=="undefined"&&l.setAttribute("style",o)}k.appendChild(l);o=e.createElementNS("http://www.w3.org/2000/svg","line");o.setAttribute("x1",p);o.setAttribute("y1",r+q*3/8);o.setAttribute("x2",n-1);o.setAttribute("y2",r+q*3/8);l=j.shapeClass;if(typeof d.shapeClass!=="undefined")l=d.shapeClass;typeof l!=="undefined"&&o.setAttribute("class",l);l=j.shapeStyle;if(typeof d.shapeStyle!=="undefined")l=d.shapeStyle;typeof l!=="undefined"&&o.setAttribute("style",l);k.appendChild(o);
o=e.createElementNS("http://www.w3.org/2000/svg","line");o.setAttribute("x1",p);o.setAttribute("y1",t-q*3/8);o.setAttribute("x2",n-1);o.setAttribute("y2",t-q*3/8);l=j.shapeClass;if(typeof d.shapeClass!=="undefined")l=d.shapeClass;typeof l!=="undefined"&&o.setAttribute("class",l);l=j.shapeStyle;if(typeof d.shapeStyle!=="undefined")l=d.shapeStyle;typeof l!=="undefined"&&o.setAttribute("style",l);k.appendChild(o);o=e.createElementNS("http://www.w3.org/2000/svg","line");o.setAttribute("x1",p+v*3/8);o.setAttribute("y1",
r);o.setAttribute("x2",p+v*3/8);o.setAttribute("y2",r+q*3/8);l=j.shapeClass;if(typeof d.shapeClass!=="undefined")l=d.shapeClass;typeof l!=="undefined"&&o.setAttribute("class",l);l=j.shapeStyle;if(typeof d.shapeStyle!=="undefined")l=d.shapeStyle;typeof l!=="undefined"&&o.setAttribute("style",l);k.appendChild(o);o=e.createElementNS("http://www.w3.org/2000/svg","line");o.setAttribute("x1",n-v*3/8);o.setAttribute("y1",r);o.setAttribute("x2",n-v*3/8);o.setAttribute("y2",r+q*3/8);l=j.shapeClass;if(typeof d.shapeClass!==
"undefined")l=d.shapeClass;typeof l!=="undefined"&&o.setAttribute("class",l);l=j.shapeStyle;if(typeof d.shapeStyle!=="undefined")l=d.shapeStyle;typeof l!=="undefined"&&o.setAttribute("style",l);k.appendChild(o);o=e.createElementNS("http://www.w3.org/2000/svg","line");o.setAttribute("x1",p+v*3/8);o.setAttribute("y1",t);o.setAttribute("x2",p+v*3/8);o.setAttribute("y2",t-q*3/8);l=j.shapeClass;if(typeof d.shapeClass!=="undefined")l=d.shapeClass;typeof l!=="undefined"&&o.setAttribute("class",l);l=j.shapeStyle;
if(typeof d.shapeStyle!=="undefined")l=d.shapeStyle;typeof l!=="undefined"&&o.setAttribute("style",l);k.appendChild(o);o=e.createElementNS("http://www.w3.org/2000/svg","line");o.setAttribute("x1",n-v*3/8);o.setAttribute("y1",t);o.setAttribute("x2",n-v*3/8);o.setAttribute("y2",t-q*3/8);l=j.shapeClass;if(typeof d.shapeClass!=="undefined")l=d.shapeClass;typeof l!=="undefined"&&o.setAttribute("class",l);l=j.shapeStyle;if(typeof d.shapeStyle!=="undefined")l=d.shapeStyle;typeof l!=="undefined"&&o.setAttribute("style",
l);k.appendChild(o);l=e.createElementNS("http://www.w3.org/2000/svg","text");l.setAttribute("x",(p+n)/2);l.setAttribute("y",t-q*3/8-6);l.setAttribute("style","font-weight: bold; text-anchor: middle");o=d.displayedText;typeof o==="undefined"&&(o="");l.appendChild(e.createTextNode(o));k.appendChild(l);var o=function(a){var a=j.dateTimeFormatter(new Date(a.valueOf()+(new Date).getTimezoneOffset()*6E4)),b;b=a.indexOf(" ");if(b>=0){value1=a.substr(0,b);value2=a.substr(b+1)}else{value1=a;value2=""}return[value1,
value2]},l=o(d.earlyStart),z=e.createElementNS("http://www.w3.org/2000/svg","text");z.setAttribute("x",p+v*3/8/2);z.setAttribute("y",t-q*5/8-20);z.setAttribute("style","text-anchor: middle");z.appendChild(e.createTextNode(l[0]));k.appendChild(z);z=e.createElementNS("http://www.w3.org/2000/svg","text");z.setAttribute("x",p+v*3/8/2);z.setAttribute("y",t-q*5/8-4);z.setAttribute("style","text-anchor: middle");z.appendChild(e.createTextNode(l[1]));k.appendChild(z);l=j.timeSpanFormatter(d.effort);z=e.createElementNS("http://www.w3.org/2000/svg",
"text");z.setAttribute("x",(p+n)/2);z.setAttribute("y",t-q*5/8-12);z.setAttribute("style","text-anchor: middle");z.appendChild(e.createTextNode(l));k.appendChild(z);l=o(d.earlyFinish);z=e.createElementNS("http://www.w3.org/2000/svg","text");z.setAttribute("x",n-v*3/8/2);z.setAttribute("y",t-q*5/8-20);z.setAttribute("style","text-anchor: middle");z.appendChild(e.createTextNode(l[0]));k.appendChild(z);z=e.createElementNS("http://www.w3.org/2000/svg","text");z.setAttribute("x",n-v*3/8/2);z.setAttribute("y",
t-q*5/8-4);z.setAttribute("style","text-anchor: middle");z.appendChild(e.createTextNode(l[1]));k.appendChild(z);l=o(d.lateStart);q=e.createElementNS("http://www.w3.org/2000/svg","text");q.setAttribute("x",p+v*3/8/2);q.setAttribute("y",t-20);q.setAttribute("style","text-anchor: middle");q.appendChild(e.createTextNode(l[0]));k.appendChild(q);q=e.createElementNS("http://www.w3.org/2000/svg","text");q.setAttribute("x",p+v*3/8/2);q.setAttribute("y",t-4);q.setAttribute("style","text-anchor: middle");q.appendChild(e.createTextNode(l[1]));
k.appendChild(q);l=j.timeSpanFormatter(d.slack);q=e.createElementNS("http://www.w3.org/2000/svg","text");q.setAttribute("x",(p+n)/2);q.setAttribute("y",t-12);q.setAttribute("style","text-anchor: middle");q.appendChild(e.createTextNode(l));k.appendChild(q);l=o(d.lateFinish);q=e.createElementNS("http://www.w3.org/2000/svg","text");q.setAttribute("x",n-v*3/8/2);q.setAttribute("y",t-20);q.setAttribute("style","text-anchor: middle");q.appendChild(e.createTextNode(l[0]));k.appendChild(q);q=e.createElementNS("http://www.w3.org/2000/svg",
"text");q.setAttribute("x",n-v*3/8/2);q.setAttribute("y",t-4);q.setAttribute("style","text-anchor: middle");q.appendChild(e.createTextNode(l[1]));k.appendChild(q);if(j.canUserRearrangeItems){e=e.createElementNS("http://www.w3.org/2000/svg","rect");e.setAttribute("x",p);e.setAttribute("y",r);e.setAttribute("width",Math.max(0,n-p-1));e.setAttribute("height",Math.max(0,t-r-1));e.setAttribute("style","fill: White; fill-opacity: 0; cursor: pointer");k.appendChild(e);ka(e,d,f,F(d,j),H(d,j),g,j)}return k}},
ca=function(a,b){return function(a,d){var g=a.networkDiagramView,c=typeof b!=="undefined"?b:g.settings,e=g.ownerDocument,g=e.createElementNS("http://www.w3.org/2000/svg","g"),f;f="M ";var k=F(a,c)-2,p=H(a,c)-2,n=F(d.item,c),r=H(d.item,c),t=F(a,c),o=H(a,c),q=Math.abs(t-n),v=Math.abs(o-r),l=c.shapeWidth+2,z=c.shapeHeight+2,y=l/2,x=z/2,w=Math.max(l,z),v=v<w*4;if(q<w)f=r<=o?f+(n+y-k+","+(r+z-p))+(" L "+(t+y-k)+","+(o-p)):f+(n+y-k+","+(r-p))+(" L "+(t+y-k)+","+(o+z-p));else{f=n<=t?f+(n+l-k+","+(r+x-p)):
f+(n-k+","+(r+x-p));f=v?n<=t?f+(" L "+(t-k)+","+(o+x-p)):f+(" L "+(t+l-k)+","+(o+x-p)):r<=o?f+(" L "+(t+y-k)+","+(o-p)):f+(" L "+(t+y-k)+","+(o+z-p))}k=e.createElementNS("http://www.w3.org/2000/svg","path");k.setAttribute("d",f);typeof c.dependencyLineZoneClass!=="undefined"&&k.setAttribute("class",c.dependencyLineZoneClass);typeof c.dependencyLineZoneStyle!=="undefined"&&k.setAttribute("style",c.dependencyLineZoneStyle);g.appendChild(k);e=e.createElementNS("http://www.w3.org/2000/svg","path");e.setAttribute("d",
f);f=c.dependencyLineClass;if(typeof d.dependencyLineClass!=="undefined")f=d.dependencyLineClass;typeof f!=="undefined"&&e.setAttribute("class",f);c=c.dependencyLineStyle;if(typeof d.dependencyLineStyle!=="undefined")c=d.dependencyLineStyle;typeof c!=="undefined"&&e.setAttribute("style",c);g.appendChild(e);return g}},da=function(){return function(a,b){var c=a.networkDiagramView.ownerDocument,d=c.createElementNS("http://www.w3.org/2000/svg","title");d.appendChild(w(c,b.item.displayedText+" - "+a.displayedText));
return d}},N=function(a,b,c,d){typeof a.networkDiagramView!=="undefined"&&a.networkDiagramView.settings.itemPropertyChangeHandler(a,b,c,d)},ka=function(a,b,c,d,g,e,f){function u(c){e.draggingItem=b;e.dragType="Position";e.style.cursor=a.style.cursor;e.draggingInitialX=c.clientX;e.draggingInitialY=c.clientY;e.draggingInitialThumbXPosition=d;e.draggingInitialThumbYPosition=g}a.addEventListener("mousedown",function(a){if(a.button==0){u(a);a.preventDefault()}},true);a.addEventListener("touchstart",function(a){u(a.touches[0]);
a.preventDefault()},true);if(typeof e.draggableItems==="undefined")e.draggableItems=[];for(var k=false,p=0;p<e.draggableItems.length;p++)if(e.draggableItems[p]==b){k=true;break}if(!k){var n=function(a){if(!(typeof e.draggingItem==="undefined"||e.draggingItem!=b||e.dragType!="Position")){var d=a.clientX-e.draggingInitialX,g=a.clientY-e.draggingInitialY;var k=a.clientX,l=e;if(typeof l.draggingItem!=="undefined"){var n=l,p=0;if(n.offsetParent){do{p=p+n.offsetLeft;n=n.offsetParent}while(n)}k=k-p;if(k<
24){k=l.chartContentContainer.scrollLeft;l.chartContentContainer.scrollLeft=l.chartContentContainer.scrollLeft-48;k=k-l.chartContentContainer.scrollLeft;if(typeof l.draggingInitialThumbXPosition!=="undefined")l.draggingInitialThumbXPosition=l.draggingInitialThumbXPosition-k}else if(k>=l.chartContentContainer.clientWidth-24){k=l.chartContentContainer.scrollLeft;l.chartContentContainer.scrollLeft=l.chartContentContainer.scrollLeft+48;k=l.chartContentContainer.scrollLeft-k;if(typeof l.draggingInitialThumbXPosition!==
"undefined")l.draggingInitialThumbXPosition=l.draggingInitialThumbXPosition+k}}l=a.clientY;a=e;if(typeof a.draggingItem!=="undefined"){k=a;n=0;if(k.offsetParent){do{n=n+k.offsetTop;k=k.offsetParent}while(k)}l=l-n;if(l<24){l=a.chartContentContainer.scrollTop;a.chartContentContainer.scrollTop=a.chartContentContainer.scrollTop-48;l=l-a.chartContentContainer.scrollTop;if(typeof a.draggingInitialThumbYPosition!=="undefined")a.draggingInitialThumbYPosition=a.draggingInitialThumbYPosition-l}else if(l>=a.chartContentContainer.clientHeight-
24){l=a.chartContentContainer.scrollTop;a.chartContentContainer.scrollTop=a.chartContentContainer.scrollTop+48;l=a.chartContentContainer.scrollTop-l;if(typeof a.draggingInitialThumbYPosition!=="undefined")a.draggingInitialThumbYPosition=a.draggingInitialThumbYPosition+l}}delete e.draggingItem;e.draggingInitialThumbXPosition+d<0&&(d=-e.draggingInitialThumbXPosition);e.draggingInitialThumbYPosition+g<0&&(g=-e.draggingInitialThumbYPosition);a=b;g=(e.draggingInitialThumbYPosition+g-f.diagramMargin)/(f.itemHeight+
f.minDependencyLineLength/f.aspectRatio);f.snapRearrangedItemsToGuidelines&&(g=Math.round(g));a.actualRowIndex=g;g=b;d=(e.draggingInitialThumbXPosition+d-f.diagramMargin)/(f.itemWidth+f.minDependencyLineLength);f.snapRearrangedItemsToGuidelines&&(d=Math.round(d));g.actualColumnIndex=d;N(b,"actualRowIndex",true,false);N(b,"actualColumnIndex",true,false);typeof b.displayedColumnIndex!=="undefined"&&delete b.displayedColumnIndex;typeof b.displayedRowIndex!=="undefined"&&delete b.displayedRowIndex;ma(b,
c,e.chartContent,f,false);e.draggingItem=b;e.draggingPerformed=true}};e.addEventListener("mousemove",function(a){n(a)},true);e.addEventListener("touchmove",function(a){n(a.touches[0])},true);var r=function(){if(!(typeof e.draggingItem==="undefined"||e.draggingItem!=b||e.dragType!="Position")){ma(b,c,e.chartContent,f,true);var a=e.draggingItem;delete e.draggingItem;e.style.cursor="default";if(e.draggingPerformed){N(a,"actualColumnIndex",true,true);N(a,"actualRowIndex",true,true);delete e.draggingPerformed}}};
document.addEventListener("mouseup",function(a){a.button==0&&r()},true);document.addEventListener("touchend",function(){r()},true);e.draggableItems.push(b)}},ma=function(a,b,c,d,g){var e=a.networkDiagramView.ownerDocument;if(g){if(typeof c.temporaryRectangle!=="undefined"){e=c.chartArea;e.removeChild(c.temporaryRectangle);delete c.temporaryRectangle}setTimeout(function(){Q(a.chartItem,a,d);A(b,a);setTimeout(function(){ea(c,b,d,true)},0)})}else{if(typeof c.temporaryRectangle!=="undefined")g=c.temporaryRectangle;
else{g=e.createElementNS("http://www.w3.org/2000/svg","rect");g.setAttribute("x",0);g.setAttribute("y",0);g.setAttribute("width",d.shapeWidth);g.setAttribute("height",d.shapeHeight);typeof d.temporaryThumbClass!=="undefined"&&g.setAttribute("class",d.temporaryThumbClass);g.setAttribute("style",d.temporaryThumbStyle);c.temporaryRectangle=g;e=c.chartArea;e.appendChild(g)}var e=F(a,d)+(d.itemWidth-d.shapeWidth)/2,f=H(a,d)+(d.itemHeight-d.shapeHeight)/2;g.setAttribute("transform","translate("+e+", "+
f+")");setTimeout(function(){ea(c,b,d,false)},0)}},ea=function(a,b,c,d){var g=K(b,c),b=E(b,c);if(d||g>a.clientWidth)a.style.width=g+"px";if(d||b>a.clientHeight)a.style.height=b+"px";a=a.chartArea;d?a.setAttribute("style","width: "+g+"px; height: "+b+"px"):a.setAttribute("style","width: "+Math.max(a.clientWidth,g)+"px; height: "+Math.max(a.clientHeight,b)+"px")},na=function(a,b){for(var c=a.childNodes.length;c-- >0;)a.removeChild(a.childNodes[c]);a.appendChild(b)},fa=function(a,b){for(var c in b)c.indexOf("custom")!=
0&&c.indexOf("description")!=0||typeof a[c]==="undefined"&&(a[c]=b[c])},ha=function(a,b,c,d,g,e,f,u,k){var c={isExport:true,canUserRearrangeItems:false,isTaskToolTipVisible:false,isDependencyToolTipVisible:false,containerClass:k.containerClass,containerStyle:k.containerStyle,border:k.border,theme:k.theme,itemWidth:k.itemWidth,itemHeight:k.itemHeight,aspectRatio:k.aspectRatio,shapeWidth:k.shapeWidth,shapeHeight:k.shapeHeight,shapeClass:k.shapeClass,milestoneClass:k.milestoneClass,shapeStyle:k.shapeStyle,
milestoneStyle:k.milestoneStyle,dependencyLineClass:k.dependencyLineClass,dependencyLineStyle:k.dependencyLineStyle,minDependencyLineLength:k.minDependencyLineLength,diagramMargin:0,target:k.target,dateTimeFormatter:k.dateTimeFormatter,timeSpanFormatter:k.timeSpanFormatter,isRelativeToTimezone:k.isRelativeToTimezone,taskTemplate:k.taskTemplate,dependencyLineTemplate:k.dependencyLineTemplate},k=K(u,c),p=E(u,c);c.chartWidth=k+"px";c.chartHeight=p+"px";var n=k+2,k=p+2,r,t,o=false;if(d!=null&&typeof d.createElement!==
"undefined")r=d;else{if(d!=null&&typeof d.focus!=="undefined")t=d;else{t=window.open("",d!=null?d:"_blank",typeof g!=="undefined"&&g&&(typeof f==="undefined"||f)?"width=320,height=100,location=no,menubar=no,toolbar=no,status=no,scrollbars=yes":"");o=true}r=t.document;try{for(var q=document.head.getElementsByTagName("link"),d=0;d<q.length;d++){var v=q[d],l=r.adoptNode(v.cloneNode(true));l.href=v.href;r.head.appendChild(l)}}catch(y){}}r.title=typeof a!=="undefined"?a:"Exported diagram"+(typeof g!==
"undefined"&&g?" (printable)":"");a=[];for(d=0;d<u.length;d++){q=u[d];v={content:q.content,earlyStart:q.earlyStart,earlyFinish:q.earlyFinish,lateStart:q.lateStart,lateFinish:q.lateFinish,isMilestone:q.isMilestone,effort:q.effort,slack:q.slack,isShapeVisible:q.isShapeVisible,isRelativeToTimezone:q.isRelativeToTimezone,shapeClass:q.shapeClass,milestoneClass:q.milestoneClass,shapeStyle:q.shapeStyle,milestoneStyle:q.milestoneStyle,displayedRowIndex:q.actualRowIndex,displayedColumnIndex:q.actualColumnIndex,
isExported:true};fa(v,q);a.push(v);q.exportItem=v}for(d=0;d<u.length;d++){q=u[d];v=q.exportItem;if(typeof q.predecessors!=="undefined"){v.predecessors=[];for(l=0;l<q.predecessors.length;l++){p=q.predecessors[l];v.predecessors.push({item:p.item.exportItem,dependencyLineClass:p.dependencyLineClass,dependencyLineStyle:p.dependencyLineStyle})}}}var x=r.createElement("p");x.innerHTML=typeof b!=="undefined"?b:"";r.body.appendChild(x);var w=r.createElement("div");w.setAttribute("style","width: "+n+"px; height: "+
k+"px");try{DlhSoft.Controls.Pert.NetworkDiagramView.initialize(w,a,c,"DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")}catch(A){}setTimeout(function(){o&&r.body.setAttribute("style","margin: 0px");var a=r.createElement("div");a.appendChild(w);r.body.replaceChild(a,x);if(e){a.setAttribute("style","width: "+w.offsetHeight+"px; height: "+n+"px; overflow: hidden");a=Math.round((w.offsetWidth-w.offsetHeight)/2);w.setAttribute("style",
"width: "+n+"px; transform: rotate(90deg) translateX("+a+"px) translateY("+a+"px); -webkit-transform: rotate(90deg) translateX("+a+"px) translateY("+a+"px)")}r.close();if(typeof t!==void 0){t.focus();if(typeof g!=="undefined"&&g){t.print();(typeof f==="undefined"||f)&&setTimeout(function(){t.close()})}}},0)},Y=function(a,b){for(var c=0;c<b.length;c++){var d=b[c];delete d.successorInfo;delete d.effortInfo}a:{for(var g=0;g<b.length;g++){c=b[g];if(typeof c.predecessors==="undefined"||c.predecessors.length==
0)break a}c=null}if(c==null)return[];a:{for(g=b.length;g-- >0;){d=b[g];if(ja(d).length==0)break a}d=null}if(d==null)return[];g=[c];c=ga(c,d);for(d=0;d<c.length;d++)g.push(c[d]);for(c=0;c<b.length;c++){d=b[c];delete d.successorInfo;delete d.effortInfo}return g},ia=function(a,b){for(var c=Y(a,b),d=[],g=0;g<c.length;g++){var e=c[g];if(typeof e.predecessors!=="undefined")for(var f=0;f<e.predecessors.length;f++){var u=e.predecessors[f];typeof u.item!=="undefined"&&c.indexOf(u.item)>=0&&d.push(u)}}return d},
ga=function(a,b){if(a==null||b==null||a==b||typeof b.predecessors==="undefined")return[];var c=[],d=[],g,e=null;for(g=0;g<b.predecessors.length;g++){predecessorItem=b.predecessors[g];if(typeof predecessorItem.item!=="undefined"){var f=R(a,predecessorItem.item);if(f!=null){predecessorItem.item.effort>0&&(f=f+predecessorItem.item.effort);if(e==null||f>=e){if(e==null||f>e){e=f;d=[]}d.push(predecessorItem)}}}}for(g=0;g<d.length;g++){nextPredecessorItem=d[g];e=ga(a,nextPredecessorItem.item);for(f=0;f<
e.length;f++)c.push(e[f]);c.push(b)}return c},R=function(a,b){if(a==null||b==null)return null;if(a==b)return 0;if(!a.effortInfo)a.effortInfo={};var c=b.index.toString();if(typeof a.effortInfo[c]!=="undefined")return a.effortInfo[c];for(var d=null,g=ja(a),e=0;e<g.length;e++){var f=g[e],u=R(f.dependentItem,b);if(u!=null){u=u+(typeof f.predecessorItem.item!=="undefined"&&f.predecessorItem.item.effort>0?f.predecessorItem.item.effort:0);u<0&&(u=0);if(d==null||u>d)d=u}}return a.effortInfo[c]=d},ja=function(a){if(a.successorInfo)return a.successorInfo;
for(var b=[],c=a.networkDiagramView.items,d=0;d<c.length;d++){var g=c[d];if(typeof g.predecessors!=="undefined")for(var e=0;e<g.predecessors.length;e++){var f=g.predecessors[e];typeof f.item!=="undefined"&&f.item==a&&b.push({dependentItem:g,predecessorItem:f})}}return a.successorInfo=b},b=function(a){for(var b=null,c=0;c<a.length;c++)if(b==null||a[c]>b)b=a[c];return b},e=function(a){return typeof a!=="undefined"?new Date(a.valueOf()+a.getTimezoneOffset()*6E4):a},c=function(a){return typeof a!=="undefined"?
new Date(a.valueOf()-a.getTimezoneOffset()*6E4):a},f=function(a,b,f){for(var d=0;d<b.length;d++){b[d].networkDiagramView=a;b[d].index=d}a.items=b;a.settings=f;a.refresh=function(){M(a)};a.refreshItems=function(){for(var a=0;a<b.length;a++){var c=b[a];B(c);W(c)}};a.refreshChartItems=function(){for(var a=0;a<b.length;a++)B(b[a])};a.refreshItem=$;a.refreshChartItem=B;a.refreshPredecessorItems=W;a.refreshItemGraph=X;a.scrollToItem=function(a){var b=F(a,f),c=b-a.networkDiagramView.chartContentContainer.scrollLeft;
if(c<0)a.networkDiagramView.chartContentContainer.scrollLeft=b;else if(c>a.networkDiagramView.chartContentContainer.clientWidth-a.networkDiagramView.settings.itemWidth)a.networkDiagramView.chartContentContainer.scrollLeft=b-(a.networkDiagramView.chartContentContainer.clientWidth-a.networkDiagramView.settings.itemWidth);b=H(a,f);c=b-a.networkDiagramView.chartContentContainer.scrollTop;if(c<0)a.networkDiagramView.chartContentContainer.scrollTop=b;else if(c>a.networkDiagramView.chartContentContainer.clientHeight-
a.networkDiagramView.settings.itemHeight)a.networkDiagramView.chartContentContainer.scrollTop=b-(a.networkDiagramView.chartContentContainer.clientHeight-a.networkDiagramView.settings.itemHeight)};a.scrollToLeft=function(){a.chartContentContainer.scrollLeft=0};a.scrollToRight=function(){a.chartContentContainer.scrollLeft=a.chartContent.clientWidth};a.scrollToTop=function(){a.chartContentContainer.scrollTop=0};a.scrollToBottom=function(){a.chartContentContainer.scrollTop=a.chartContent.clientHeight};
a.getChartWidth=function(){return K(b,f)};a.getChartHeight=function(){return E(b,f)};a.getItemTop=function(a){return H(a,f)};a.getItemLeft=function(a){return F(a,f)};a.onItemPropertyChanged=N;a.initializeTaskDraggingThumbs=function(b,c,d,e){ka(b,c,a.items,d,e,a,a.settings)};a.exportContent=function(a,c){typeof a==="undefined"&&(a={});ha(a.title,a.preparingMessage,a.isRelativeToTimezone,c,false,a.rotate,false,b,f)};a.print=function(a){typeof a==="undefined"&&(a={});ha(a.title,a.preparingMessage,a.isRelativeToTimezone,
null,true,a.rotate,a.autoClose,b,f)};a.isItemCritical=function(a,c){return Y(c,b).indexOf(a)>=0};a.isDependencyCritical=function(a,c){return ia(c,b).indexOf(a)>=0};a.getCriticalItems=function(a){return Y(a,b)};a.getCriticalDependencies=function(a){return ia(a,b)};a.repositionEnds=function(){if(b.length!=0){for(var a=false,c=0;c<b.length;c++){for(var d=b[c],e=0,f=0;f<b.length;f++){var m=b[f];if(typeof m.predecessors!=="undefined"){for(var n=0;n<m.predecessors.length;n++)if(typeof m.predecessors[n].item!==
"undefined"&&m.predecessors[n].item==d){e++;if(e>1)break}if(e>1)break}}e>1&&(a=true)}c=b[0];c.displayedRowIndex=a?0.5:0;d=b[b.length-1];d.displayedRowIndex=a?0.5:0;X(c);X(d)}};a.getOutputDate=e;a.getInputDate=c};return{initialize:L,initializeItems:U,refresh:M,getDefaultStyleDefinitionTemplate:aa,getDefaultTaskTemplate:S,getDefaultItemTemplate:ba,getDefaultDependencyLineTemplate:ca,getDefaultPredecessorItemTemplate:da,initializeTaskDraggingThumbs:function(a,b,c,d){b.networkDiagramView.initializeTaskDraggingThumbs(a,
b,c,d)},defaultDateTimeFormatter:function(a){return y(new Date(a.valueOf()+(new Date).getTimezoneOffset()*6E4))},defaultTimeSpanFormatter:C,getOutputDate:e,getInputDate:c}}());
